# This configuration file was automatically generated by Gitpod.
# Please adjust to your needs (see https://www.gitpod.io/docs/config-gitpod-file)
# and commit this file to your remote git repository to share the goodness with others.

tasks:
  - name: Install Rust
    before: |
      # 這個做法有點 hacky⋯⋯讓 rustup 根據
      # rust-toolchain.toml 下載需要的版本。
      cargo -V
      gp sync-done rust-installation

  - name: Binding /bin/bash
    before: |
      # 將 /bin/sh 綁定為 /bin/bash (workaround 無法 scripts/check.sh 的問題)
      sudo ln -fs /bin/bash /bin/sh

  - name: Install cargo utilities
    init: |
      gp sync-await rust-installation

      # 安裝 cargo-workspace 和 cargo-udeps
      cargo install cargo-workspace cargo-udeps

  - name: Prebuild server-rust
    init: |
      gp sync-await rust-installation

      # 組建檢查檔案，以及 development 和 release 的編譯檔案
      cargo check
      cargo build
      cargo build --release

vscode:
  extensions:
    # Rust
    - "rust-lang.rust-analyzer"
    - "Zerotaskx.rust-extension-pack"

    # Git
    - "cschleiden.vscode-github-actions"
    - "eamodio.gitlens"
    - "donjayamanne.githistory"
    - "mhutchie.git-graph"

    # Pan's development tools
    - "GitHub.copilot"
    - "felipe.nasc-touchbar"
